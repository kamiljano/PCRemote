package pcremote.activities;

import pcremote.custom.MouseController;
import pcremote.storage.Preferences;
import pcremote.storage.PreferencesStorage;
import android.app.Activity;
import android.os.Bundle;
import android.widget.SeekBar;
import android.widget.Toast;

public class PreferencesActivity extends Activity{

	private SeekBar cursorSens;
	
	@Override
	public void onCreate(Bundle bund)
	{
		super.onCreate(bund);
		setContentView(R.layout.preferences_activity);
		cursorSens = (SeekBar)findViewById(R.id.cursorSens);
		cursorSens.setOnSeekBarChangeListener(cursorSensListener);
		try
		{
			Preferences p = PreferencesStorage.getPreferences();
			cursorSens.setProgress((int)(p.cursorSensitvity * 100));
		}
		catch(Exception e)
		{
			//Toast.makeText(this, "fail", Toast.LENGTH_SHORT).show();
		}
		//Toast.makeText(this, "ok", Toast.LENGTH_SHORT).show();
	}
	
	private SeekBar.OnSeekBarChangeListener cursorSensListener = new SeekBar.OnSeekBarChangeListener() {
		
		public void onStopTrackingTouch(SeekBar seekBar) {
			// TODO Auto-generated method stub
			
		}
		
		public void onStartTrackingTouch(SeekBar seekBar) {
			// TODO Auto-generated method stub
			
		}
		
		public void onProgressChanged(SeekBar seekBar, int progress,
				boolean fromUser) {
			MouseController.setMouseSensitivity((float)(progress / 100));
			//Toast.makeText(PreferencesActivity.this, Integer.toString(progress), Toast.LENGTH_SHORT).show();
			
		}
	};
	
	@Override
	public void onStop()
	{
		super.onStop();
		PreferencesStorage.setContext(this);
		try
		{
			PreferencesStorage.savePreferences((float)(cursorSens.getProgress()/100.0));
		}
		catch (Exception e)
		{
			Toast.makeText(this, getString(R.string.prefsStoreFail), Toast.LENGTH_SHORT).show();
		}
	}
}
